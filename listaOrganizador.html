<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Corridas Cadastradas — Make the Run</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="header">
    <div class="brand">
      <div class="logo-img-wrapper">
        <img src="runner.png" class="header-logo" />
      </div>
      <div>
        <h1>
          <span class="green">Make</span> the <span class="orange">Run</span>
        </h1>
        <p class="subtitle">Corridas Cadastradas</p>
      </div>
    </div>
    <nav class="nav">
      <a href="index.html" class="btn outline">Início</a>
      <a href="organizador.html" class="btn outline">Organizador </a>
    </nav>
  </header>

  <main class="container">
    <section class="card">
      <h2>Corridas Cadastradas</h2>
      <p id="contador">Carregando corridas...</p>
      
      <div id="listaCorridas" class="corridas-lista">
        <!-- As corridas serão carregadas aqui via JavaScript -->
      </div>
      
      <div class="form-buttons">
        <a href="organizador.html" class="btn primary">Organizador </a>
      </div>
    </section>
  </main>

  <footer class="footer">
    © 2026 Make the Run — Gerenciamento de eventos esportivos
  </footer>

  <script type="module">
    import { StorageService } from "./services/StorageService.js";

    function formatarData(dataStr) {
      if (!dataStr) return "Data não definida";
      const data = new Date(dataStr + 'T00:00:00');
      return data.toLocaleDateString('pt-BR');
    }

    function carregarCorridas() {
      const corridas = StorageService.listarCorridas();
      const container = document.getElementById("listaCorridas");
      const contador = document.getElementById("contador");

      contador.textContent = `Total de corridas: ${corridas.length}`;

      if (corridas.length === 0) {
        container.innerHTML = `
          <div class="corrida-vazia">
            <p>Nenhuma corrida cadastrada ainda.</p>
            <p>Clique em "Cadastrar Nova Corrida" para começar.</p>
          </div>
        `;
        return;
      }

      let html = '';
      corridas.forEach((corrida, index) => {
        html += `
          <div class="corrida-card">
            <div class="corrida-header">
              <h3>${corrida.nome || 'Sem nome'}</h3>
              <span class="corrida-categoria">${corrida.categoria || 'Sem categoria'}</span>
            </div>
            <div class="corrida-info">
              <p><strong>Data:</strong> ${formatarData(corrida.data)}</p>
              <p><strong>Local:</strong> ${corrida.local || 'Não informado'}</p>
              <p><strong>Distância:</strong> ${corrida.distancia || corrida.distanciaKM || '0'} km</p>
              <p><strong>Limite de atletas:</strong> ${corrida.limiteAtletas || corrida.vagas || '0'}</p>
              <p><strong>Descrição:</strong> ${corrida.descricao || 'Sem descrição'}</p>
              ${corrida.descricaoGeral ? `<p><strong>Detalhes:</strong> ${corrida.descricaoGeral}</p>` : ''}
            </div>
            <div class="corrida-acoes">
              <span class="corrida-id">#${index + 1}</span>
            </div>
          </div>
        `;
      });

      container.innerHTML = html;
    }

    // Carregar corridas quando a página abrir
    carregarCorridas();
  </script>
</body>
</html>